"use strict";(()=>{var n=class{constructor(){this.events={}}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(i=>i!==t))}emit(e,...t){this.events[e]&&this.events[e].forEach(i=>i(...t))}},r=new n;window.addEventListener("message",o=>{let e=o.data,t=e.type;t==="PROPERTIES"?r.emit("properties",e.properties,{tileId:e.tileId,actionId:e.actionId}):t==="PLUGIN_MESSAGE"?r.emit("plugin_message",e.message):t==="REFRESH"&&window.location.reload()});function d(o,e){let t;return function(...i){t&&clearTimeout(t),t=setTimeout(()=>{o.apply(this,i)},e)}}function s(o){window.parent.postMessage(o,"*")}function l(){s({type:"GET_PROPERTIES"})}function c(o,e){a({[o]:e})}function a(o){s({type:"SET_PROPERTIES",properties:o})}function p(o){s({type:"SEND_TO_PLUGIN",message:o})}function g(o){return r.on("plugin_message",o),()=>{r.off("plugin_message",o)}}function u(o){return r.on("properties",o),()=>{r.off("properties",o)}}function f(){}function b(){}window.tilepad={onPluginMessage:g,onProperties:u,requestProperties:l,sendPluginMessage:p,setProperty:d(c,100),setProperties:a,setLabel:f,setIcon:b};})();
